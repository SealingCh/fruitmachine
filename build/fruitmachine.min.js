/*! fruitmachine 2013-04-23 */
(function(t){if("function"==typeof bootstrap)bootstrap("fruitmachine",t);else if("object"==typeof exports)module.exports=t();else if("function"==typeof define&&define.amd)define(t);else if("undefined"!=typeof ses){if(!ses.ok())return;ses.makeFruitMachine=t}else"undefined"!=typeof window?window.FruitMachine=t():global.FruitMachine=t()})(function(){return function(t,e,i){function r(i,o){if(!e[i]){if(!t[i]){var s="function"==typeof require&&require;if(!o&&s)return s(i,!0);if(n)return n(i,!0);throw Error("Cannot find module '"+i+"'")}var u=e[i]={exports:{}};t[i][0](function(e){var n=t[i][1][e];return r(n?n:e)},u,u.exports)}return e[i].exports}for(var n="function"==typeof require&&require,o=0;i.length>o;o++)r(i[o]);return r}({1:[function(t,e,i){"use strict";i.bind=function(t,e){return function(){return t.apply(e,arguments)}},i.isArray=function(t){return t instanceof Array},i.mixin=function(t){return[].slice.call(arguments,1).forEach(function(e){for(var i in e)t[i]=e[i]}),t},i.querySelectorId=function(t,e){return e?e.querySelector("#"+t):void 0},i.insert=function(t,e,i){i!==void 0?e.splice(i,0,t):e.push(t)},i.toNode=function(t){var e=document.createElement("div");return e.innerHTML=t,e.removeChild(e.firstElementChild)},i.hasDom=function(){return"undefined"!=typeof document};var r=0;i.uniqueId=function(t,e){return t=t||"id",e=e||"a",[t,++r*Math.round(1e5*Math.random()),e].join("-")},i.keys=function(t){var e=[];for(var i in t)e.push(i);return e},i.isPlainObject=function(t){if(!t)return!1;var e=""+(t.constructor||"");return!!~e.indexOf("Object")}},{}],2:[function(t,e){e.exports={modules:{}}},{}],3:[function(t,e){"use strict";function i(t){return new i.View(t)}i.VERSION="0.2.5",i.View=t("./view"),i.Model=t("./model"),i.Events=t("event"),i.define=t("./define"),i.util=t("./util"),i.store=t("./store"),i.config=t("./config").set,e.exports=i},{"./view":4,"./model":5,"./define":6,"./util":1,"./store":2,"./config":7,event:8}],6:[function(t,e){"use strict";function i(t,e){for(var i in e)e.hasOwnProperty(i)&&~t.indexOf(i)&&(e["_"+i]=e[i],delete e[i])}var r=t("./view"),n=t("./store"),o=t("./util"),s=o.keys(r.prototype);e.exports=function(t){var e=t.__super__?t:r.extend(t);return i(s,e.prototype),n.modules[e.prototype._module]=e}},{"./view":4,"./store":2,"./util":1}],7:[function(t,e){var i=t("./store"),r=t("./util").mixin,n=i.config=e.exports={templateIterator:"children",templateInstance:"child",model:{toJSON:function(t){return t.toJSON()}}};n.set=function(t){r(n,t)}},{"./store":2,"./util":1}],8:[function(t,e){function i(t,e){for(var i in e)t[i]=e[i];return t}var r=e.exports=function(t){return this instanceof r?t?i(t,r.prototype):void 0:new r(t)};r.prototype.on=function(t,e){return this._cbs=this._cbs||{},(this._cbs[t]||(this._cbs[t]=[])).push(e),this},r.prototype.off=function(t,e){if(this._cbs=this._cbs||{},!t)return this._cbs={};if(!e)return delete this._cbs[t];for(var i,r=this._cbs[t]||[];r&&~(i=r.indexOf(e));)r.splice(i,1);return this},r.prototype.fire=function(t){this._cbs=this._cbs||{};for(var e=this._cbs[t]||(this._cbs[t]=[]),i=[].slice.call(arguments,1),r=e.length;r--;)e[r].apply(null,i);return this}},{}],9:[function(t,e){"use strict";var i=t("./util").mixin;e.exports=function(t){function e(){this.constructor=n}var r=this,n=function(){return r.apply(this,arguments)};return i(n,r),e.prototype=r.prototype,n.prototype=new e,i(n.prototype,t),n.__super__=r.prototype,n}},{"./util":1}],4:[function(t,e){"use strict";function i(t){if(t=p({},t),t.module){var e=h.modules[t.module]||i;return t._module=t.module,delete t.module,new e(t)}this._configure(t),this.add(t.children),this.initialize&&this.initialize(t),this.fire("initialize",[t],{propagate:!1})}var r=t("./config"),n=t("./extend"),o=t("event"),s=t("./model"),u=t("./util"),h=t("./store"),p=u.mixin;e.exports=i,i.prototype._configure=function(t){this._module=this._module||t._module,this._id=t.id||u.uniqueId("auto_"),this._fmid=t.fmid||u.uniqueId("fmid"),this.tag=t.tag||this.tag||"div",this.classes=this.classes||t.classes||[],this.helpers=this.helpers||t.helpers||[],this.template=this.setTemplate(t.template||this.template),this.children=[],this._ids={},this._modules={};var e=t.model||t.data||{};this.model=u.isPlainObject(e)?new s(e):e,this.helpers.forEach(this.attachHelper,this)},i.prototype.attachHelper=function(t){t&&t(this)},i.prototype.setTemplate=function(t){return t&&t.render?u.bind(t.render,t):t},i.prototype.add=function(t,e){var r,n=e&&e.at,o=e&&e.inject;if(!t)return this;t=[].concat(t);for(var s=0,h=t.length;h>s;s++)r=t[s],r instanceof i||(r=new i(r)),u.insert(r,this.children,n),this._addLookup(r),r.parent=this,o&&this.injectElement(r.el,e);return this},i.prototype.remove=function(t,e){if(t instanceof i)return t.remove(e),this;var r,n=t||{},o=n.fromDOM!==!1,s=this.parent,u=this.el;return o&&u&&u.parentNode&&u.parentNode.removeChild(u),s&&(r=s.children.indexOf(this),s.children.splice(r,1),s._removeLookup(this)),this},i.prototype._addLookup=function(t){this._modules[t._module]=this._modules[t._module]||[],this._modules[t._module].push(t),this._ids[t.id()]=t},i.prototype._removeLookup=function(t){var e=this._modules[t._module].indexOf(t);this._modules[t._module].splice(e,1),delete this._ids[t._id]},i.prototype.injectElement=function(t,e){var i=e&&e.at,r=this.el;t&&r&&(i!==void 0?r.insertBefore(t,r.children[i]):r.appendChild(t))},i.prototype.id=function(t){if(!t)return this._id;var e=this._ids[t];return e?e:this.each(function(e){return e.id(t)})},i.prototype.module=function(t){if(!t)return this._module;var e=this._modules[t];return e?e[0]:this.each(function(e){return e.module(t)})},i.prototype.modules=function(t){var e=this._modules[t]||[];return this.each(function(i){e=e.concat(i.modules(t))}),e},i.prototype.each=function(t){for(var e,i=this.children.length,r=0;i>r;r++)if(e=t(this.children[r]))return e},i.prototype.toHTML=function(){var t,e,i=r.model.toJSON,n={};return this.html?this.html:(n[r.templateIterator]=[],this.each(function(o){t=o.toHTML(),n[o.id()]=t,e={},e[r.templateInstance]=t,n.children.push(p(e,i(o.model)))}),t=this.template?this.template(p(n,i(this.model))):"",this.html=this._wrapHTML(t))},i.prototype._wrapHTML=function(t){return"<"+this.tag+' class="'+this._module+" "+this.classes.join(" ")+'" id="'+this._fmid+'">'+t+"</"+this.tag+">"},i.prototype.render=function(){var t=this.toHTML(),e=u.toNode(t);return this.setElement(e),this.fire("render",{propagate:!1}),this},i.prototype.setup=function(t){var e=t&&t.shallow;return this.getElement()?(this.isSetup&&this.teardown({shallow:!0}),this.fire("before setup",{propagate:!1}),this._setup&&this._setup(),this.fire("setup",{propagate:!1}),this.isSetup=!0,e||this.each(function(t){t.setup()}),this):this},i.prototype.teardown=function(t){var e=t&&t.shallow;return e||this.each(function(t){t.teardown()}),this.isSetup&&(this.fire("before teardown",{propagate:!1}),this._teardown&&this._teardown(),this.fire("teardown",{propagate:!1}),this.isSetup=!1),this},i.prototype.destroy=function(t){for(var e=this.children.length;e--;)this.children[e].destroy({fromDOM:!1});return this.destroyed?this:(this.remove(t),this.teardown(t,{shallow:!0}),this.fire("before destroy",{propagate:!1}),this._destroy&&this._destroy(),this.fire("destroy",{propagate:!1}),this.off(),this.destroyed=!0,this.el=this.model=this.parent=this._modules=this._module=this._ids=this._id=null,void 0)},i.prototype.empty=function(){for(var t=this.children.length;t--;)this.children[t].destroy();return this},i.prototype.closestElement=function(){for(var t=this.parent;t&&!t.el&&t.parent;)t=t.parent;return t&&t.el},i.prototype.getElement=function(){return u.hasDom()?this.el=this.el||document.getElementById(this._fmid)||this.parent&&u.querySelectorId(this._fmid,this.closestElement()):void 0},i.prototype.setElement=function(t){var e=this.el;return e&&e.parentNode&&e.parentNode.replaceChild(t,e),this.purgeElementCaches(),this.el=t,this},i.prototype.purgeElementCaches=function(){this.el=null,this.each(function(t){t.purgeElementCaches()})},i.prototype.inDOM=function(){return this.parent?this.parent.inDOM():!(!this.el||!this.el.parentNode)},i.prototype.inject=function(t){return t&&(t.innerHTML="",this.appendTo(t)),this},i.prototype.appendTo=function(t){return this.el&&t&&t.appendChild&&t.appendChild(this.el),this},i.prototype.toJSON=function(){var t={};return t.children=[],this.each(function(e){t.children.push(e.toJSON())}),t.id=this.id(),t.fmid=this._fmid,t.module=this._module,t.model=this.model.get(),t},i.prototype.on=o.prototype.on,i.prototype.off=o.prototype.off,i.prototype.fire=function(t,e,i){var r;return u.isArray(e)||(i=e,e=[]),i=i||{target:this,stopPropagation:function(){this.propagate=!1}},o.prototype.fire.apply(this,[t,i].concat(e)),r=i.propagate!==!1,r&&this.parent&&this.parent.fire(t,e,i),this},i.extend=n},{"./config":7,"./extend":9,"./model":5,"./util":1,"./store":2,event:8}],5:[function(t,e){"use strict";function i(t){this._data=n({},t)}var r=t("event"),n=t("./util").mixin;e.exports=i,i.prototype.get=function(t){return this._data[t]},i.prototype.set=function(t,e){if("string"==typeof t&&e&&(this._data[t]=e,this.fire("change:"+t,e)),"object"==typeof t){n(this._data,t);for(var i in t)this.fire("change:"+i,t[i])}return this.fire("change"),this},i.prototype.clear=function(){return this._data={},this.fire("change"),this},i.prototype.destroy=function(){for(var t in this._data)this._data[t]=null;delete this._data,this.fire("destroy")},i.prototype.toJSON=function(){return n({},this._data)},r(i.prototype)},{"./util":1,event:8}]},{},[3])(3)});