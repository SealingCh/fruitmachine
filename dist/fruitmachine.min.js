/*! fruitmachine 2013-04-03 */
(function(t){if("function"==typeof bootstrap)bootstrap("fruitmachine",t);else if("object"==typeof exports)module.exports=t();else if("function"==typeof define&&define.amd)define(t);else if("undefined"!=typeof ses){if(!ses.ok())return;ses.makeFruitMachine=t}else"undefined"!=typeof window?window.FruitMachine=t():global.FruitMachine=t()})(function(){return function(t,e,i){function n(i,r){if(!e[i]){if(!t[i]){var s="function"==typeof require&&require;if(!r&&s)return s(i,!0);if(o)return o(i,!0);throw Error("Cannot find module '"+i+"'")}var h=e[i]={exports:{}};t[i][0](function(e){var o=t[i][1][e];return n(o?o:e)},h,h.exports)}return e[i].exports}for(var o="function"==typeof require&&require,r=0;i.length>r;r++)n(i[r]);return n}({1:[function(t,e){"use strict";function i(t){return new i.View(t)}i.VERSION="0.2.5",i.Events=t("./events"),i.View=t("./view"),i.Model=t("./model"),i.define=t("./define"),i.util=t("./util"),i.store=t("./store"),e.exports=i},{"./events":2,"./view":3,"./model":4,"./define":5,"./util":6,"./store":7}],2:[function(t,e,i){var n=/\s+/,o=[].slice;i.on=function(t,e,i){var o,r,s,h,u;if(!e)return this;for(t=t.split(n),o=this._callbacks||(this._callbacks={}),r=t.shift();r;)u=o[r],s=u?u.tail:{},s.next=h={},s.context=i,s.callback=e,o[r]={tail:h,next:u?u.next:s},r=t.shift();return this},i.off=function(t,e,i){var o,r,s,h,u,a;if(r=this._callbacks){if(!(t||e||i))return delete this._callbacks,this;for(t=t?t.split(n):Object.keys(r);o=t.shift();)if(s=r[o],delete r[o],s&&(e||i))for(h=s.tail;(s=s.next)!==h;)u=s.callback,a=s.context,(e&&u!==e||i&&a!==i)&&this.on(o,u,a);return this}},i.trigger=function(t){var e,i,r,s,h,u,a;if(!(r=this._callbacks))return this;for(u=r.all,t=t.split(n),a=o.call(arguments,1);e=t.shift();){if(i=r[e])for(s=i.tail;(i=i.next)!==s;)i.callback.apply(i.context||this,a);if(i=u)for(s=i.tail,h=[e].concat(a);(i=i.next)!==s;)i.callback.apply(i.context||this,h)}return this}},{}],6:[function(t,e,i){"use strict";i.bind=function(t,e){return function(){return t.apply(e,arguments)}},i.isArray=function(t){return t instanceof Array},i.mixin=function(t){return[].slice.call(arguments,1).forEach(function(e){for(var i in e)t[i]=e[i]}),t},i.querySelectorId=function(t,e){return e?e.querySelector("#"+t):void 0},i.insert=function(t,e,i){i!==void 0?e.splice(i,0,t):e.push(t)},i.toNode=function(t){var e=document.createElement("div");return e.innerHTML=t,e.removeChild(e.firstElementChild)},i.hasDom=function(){return"undefined"!=typeof document};var n=0;i.uniqueId=function(t,e){return t=t||"id",e=e||"a",[t,++n*Math.round(1e5*Math.random()),e].join("-")}},{}],7:[function(t,e){e.exports={modules:{}}},{}],3:[function(t,e){"use strict";function i(t){if(t=u({},t),t.module){var e=h.modules[t.module]||i;return t._module=t.module,delete t.module,new e(t)}this._configure(t),this.add(t.children),this.onInitialize(t),this.trigger("initialize",[t],{propagate:!1})}var n=t("./extend"),o=t("./events"),r=t("./model"),s=t("./util"),h=t("./store"),u=s.mixin;e.exports=i,i.prototype._configure=function(t){this._module=this._module||t._module,this._id=t.id||s.uniqueId("auto_"),this._fmid=t.fmid||s.uniqueId("fmid"),this.tag=t.tag||this.tag||"div",this.classes=this.classes||t.classes||[],this.helpers=this.helpers||t.helpers||[],this.template=this.setTemplate(t.template||this.template),this._children=[],this._ids={},this._modules={},this.model=t.model||new r(t.data||{}),this.helpers.forEach(this.attachHelper,this),this.purgeHtmlCache=s.bind(this.purgeHtmlCache,this),this.model.on("change",this.purgeHtmlCache)},i.prototype.attachHelper=function(t){"function"==typeof t&&t&&t(this)},i.prototype.setTemplate=function(t){return t&&t.render?s.bind(t.render,t):t},i.prototype.add=function(t,e){var n,o=e&&e.at,r=e&&e.inject;if(!t)return this;t=[].concat(t);for(var h=0,u=t.length;u>h;h++)n=t[h],n instanceof i||(n=new i(n)),s.insert(n,this._children,o),this._addLookup(n),n.parent=this,r&&this.injectElement(n.el,e);return this.purgeHtmlCache(),this},i.prototype._addLookup=function(t){this._modules[t._module]=this._modules[t._module]||[],this._modules[t._module].push(t),this._ids[t.id()]=t},i.prototype._removeLookup=function(t){var e=this._modules[t._module].indexOf(t);this._modules[t._module].splice(e,1),delete this._ids[t._id]},i.prototype.injectElement=function(t,e){var i=e&&e.at,n=this.el;t&&n&&(i!==void 0?n.insertBefore(t,n.children[i]):n.appendChild(t))},i.prototype.id=function(t){if(!t)return this._id;var e=this._ids[t];return e?e:this.each(function(e){return e.id(t)})},i.prototype.module=function(t){if(!t)return this._module;var e=this._modules[t];return e?e[0]:this.each(function(e){return e.module(t)})},i.prototype.modules=function(t){var e=this._modules[t]||[];return this.each(function(i){e=e.concat(i.modules(t))}),e},i.prototype.child=function(t){var e=this._modules[t]||this._ids[t];return e?e[0]||e:void 0},i.prototype.children=function(t){return t?this._modules[t]||this._ids[t]||[]:this._children},i.prototype.each=function(t){for(var e,i=this.children(),n=i.length,o=0;n>o;o++)if(e=t(i[o]))return e},i.prototype.toHTML=function(){var t,e={};return this.html?this.html:(e.children=[],this.each(function(i){t=i.toHTML(),e[i.id()]=t,e.children.push(u({child:t},i.model.get()))}),t=this.template?this.template(u(e,this.model.get())):"",this.html=this._wrapHTML(t))},i.prototype._wrapHTML=function(t){return"<"+this.tag+' class="'+this._module+" "+this.classes.join(" ")+'" id="'+this._fmid+'">'+t+"</"+this.tag+">"},i.prototype.render=function(){var t=this.toHTML(),e=s.toNode(t);return this.setElement(e),this.trigger("render",{propagate:!1}),this},i.prototype.setup=function(t){var e=t&&t.shallow;return e||this.each(function(t){t.setup()}),this.getElement()?(this.isSetup&&this.teardown({shallow:!0}),this.trigger("setup",{propagate:!1}),this.onSetup(),this.isSetup=!0,this):this},i.prototype.teardown=function(t){var e=t&&t.shallow;return e||this.each(function(t){t.teardown()}),this.isSetup?(this.trigger("teardown",{propagate:!1}),this.onTeardown(),this.isSetup=!1,this):this},i.prototype.destroy=function(t){for(var e=this._children,i=e.length;i--;)e[i].destroy({el:!1});return this.destroyed?this:(this.remove(t),this.teardown(t),this.trigger("destroy",{propagate:!1}),this.onDestroy(),this.model.off("change",this.purgeHtmlCache),this.off(),this.destroyed=!0,this.el=this.model=this.parent=this._modules=this._module=this._ids=this._id=null,void 0)},i.prototype.onInitialize=function(){},i.prototype.onSetup=function(){},i.prototype.onTeardown=function(){},i.prototype.onDestroy=function(){},i.prototype.remove=function(t){t=t||{};var e,i=this.el;return t.el!==!1&&i&&i.parentNode&&i.parentNode.removeChild(i),this.parent?(e=this.parent._children.indexOf(this),this.parent._children.splice(e,1),this.parent._removeLookup(this),this):this},i.prototype.empty=function(){for(var t=this.children(),e=t.length;e--;)t[e].destroy();return this},i.prototype.closestElement=function(){for(var t=this.parent;t&&!t.el&&t.parent;)t=t.parent;return t&&t.el},i.prototype.getElement=function(){return s.hasDom()?this.el=this.el||document.getElementById(this._fmid)||this.parent&&s.querySelectorId(this._fmid,this.closestElement()):void 0},i.prototype.setElement=function(t){var e=this.el;return e&&e.parentNode&&e.parentNode.replaceChild(t,e),this.purgeElementCaches(),this.el=t,this},i.prototype.purgeElementCaches=function(){this.each(function(t){t.purgeElementCaches()}),this.el=null},i.prototype.purgeHtmlCache=function(){return this.html=null,this.parent&&this.parent.purgeHtmlCache(),this},i.prototype.data=function(t,e){return t||e?"string"!=typeof t||e?t&&e?(this.model.set(t,e),this):"object"==typeof t?(this.model.set(t),this):void 0:this.model.get(t):this.model.get()},i.prototype.inDOM=function(){return this.parent?this.parent.inDOM():!(!this.el||!this.el.parentNode)},i.prototype.inject=function(t){return t&&(t.innerHTML="",this.appendTo(t)),this},i.prototype.appendTo=function(t){return this.el&&t&&t.appendChild&&t.appendChild(this.el),this},i.prototype.toJSON=function(){var t={};return t.children=[],this.each(function(e){t.children.push(e.toJSON())}),t.id=this.id(),t.fmid=this._fmid,t.module=this._module,t.data=this.model.get(),t},i.prototype.on=o.on,i.prototype.off=o.off,i.prototype.trigger=function(t,e,i){var n;return s.isArray(e)||(i=e,e=[]),i=i||{target:this,stopPropagation:function(){this.propagate=!1}},o.trigger.apply(this,[t,i].concat(e)),n=i.propagate!==!1,n&&this.parent&&this.parent.trigger(t,e,i),this},i.extend=n},{"./extend":8,"./events":2,"./model":4,"./util":6,"./store":7}],4:[function(t,e){"use strict";function i(t){this.fmid=o.uniqueId("model"),this._data=r({},t)}var n=t("./events"),o=t("./util"),r=o.mixin;e.exports=i,i.prototype.get=function(t){return t?this._data[t]:this._data},i.prototype.set=function(t,e){var i;if("string"==typeof t&&e&&(i={},i[t]=e,t=i),"object"==typeof t){r(this._data,t),this.trigger("change");for(var n in t)this.trigger("change:"+n,t[n])}return this},i.prototype.clear=function(){return this._data={},this},i.prototype.destroy=function(){this._data=null},i.prototype.toJSON=function(){return r({},this._data)},r(i.prototype,n)},{"./events":2,"./util":6}],5:[function(t,e){"use strict";var i=t("./view"),n=t("./store");e.exports=function(t){var e,o=t.module||"undefined";return delete t.module,t._module=o,e=t.__super__?t:i.extend(t),n.modules[o]=e}},{"./view":3,"./store":7}],8:[function(t,e){"use strict";var i=t("./util").mixin;e.exports=function(t){function e(){this.constructor=n}var n,o=this;return n=function(){return o.apply(this,arguments)},e.prototype=o.prototype,n.prototype=new e,i(n.prototype,t),n.__super__=o.prototype,n}},{"./util":6}]},{},[1])(1)});