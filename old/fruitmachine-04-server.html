<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>title</title>
</head>
<body>
	<div id='app'>

		<div class="layout-i">
			<div class="module-apple js-module" data-module-id="1" data-module-type="apple">
				<h1>This is apples title</h1>
				<div>This is apples body</div>
			</div>
			<div class="module-orange js-module" data-module-id="2" data-module-type="orange">
				<h1>This is module orange title</h1>
				<div>This is module orange body</div>
			</div>
			<div class="module-tangerine js-module" data-module-id="3" data-module-type="tangerine">
				<h2>test title</h2>
				<div class="module-sharon js-module" data-module-id="dynamic1" data-module-type="sharon" data-model-data="%7B%22title%22%3A%22test%20title%22%2C%22items%22%3A%5B%7B%22title%22%3A%22item%201%22%2C%22body%22%3A%22item%201%20body%22%7D%2C%7B%22title%22%3A%22item%202%22%2C%22body%22%3A%22item%202%20body%22%7D%2C%7B%22title%22%3A%22item%203%22%2C%22body%22%3A%22item%203%20body%22%7D%5D%7D" data-parent="3">
					<h4>item 1</h4>
					<div>item 1 body</div>
					<h4>item 2</h4>
					<div>item 2 body</div>
					<h4>item 3</h4>
					<div>item 3 body</div>
				</div>
			</div>
		</div>
	</div>
<script type="text/javascript" src="hogan.js"></script>
<script type="text/javascript" src="fruitmachine-04.js"></script>
<script>


FruitMachine.templates({
	'i': Hogan.compile('<div class="layout-i">{{{module_1}}}{{{module_2}}}{{{module_3}}}</div>'),
	'apple': Hogan.compile('<div class="module-apple {{{fm_classes}}}" {{{fm_attrs}}}><h1>{{title}}</h1><div>{{body}}</div></div>'),
	'orange': Hogan.compile('<div class="module-orange {{{fm_classes}}}" {{{fm_attrs}}}><h1>This is module orange title</h1><div>This is module orange body</div></div>'),
	'tangerine': Hogan.compile('<div class="module-tangerine {{{fm_classes}}}" {{{fm_attrs}}}>{{#modules}}<h2>{{title}}</h2><div>{{{module}}}</div>{{/modules}}</div>'),
	'sharon': Hogan.compile('<div class="module-sharon {{{fm_classes}}}" {{{fm_attrs}}}>{{#items}}<h4>{{title}}</h4><div>{{body}}</div>{{/items}}</div>')
});



var structure = {
	_id: 'master',
	module: 'i',
	children: [
		{
			_id: 1,
			module: 'apple',
			data: {
				title: 'This is apples title',
				body: 'This is apples body'
			}
		},
		{
			_id: 2,
			module: 'orange',
		},
		{
			_id: 3,
			module: 'tangerine',
			children: []
		}
	]
};


console.profile('fm');

var myModel = new FruitMachine.Model(structure);

var myView = new FruitMachine.View({
	server: true,
	model: myModel,
	el: document.getElementById('app').firstElementChild
});

myView.setup();


console.profileEnd('fm');



setTimeout(function() {

console.profile('fm - update');

	var tangerineModel = myModel.child('tangerine');

	tangerineModel.addModel({
		module: 'sharon',
		data: {
			title: 'test title new',
			items: [
				{
					title: 'item 1',
					body: 'item 1 body'
				},
				{
					title: 'item 2',
					body: 'item 2 body'
				},
				{
					title: 'item 3',
					body: 'item 3 body'
				}
			]
		}
	});
//debugger;
	myView
		.child('tangerine')
		.render()
		.setup();

console.profileEnd('fm - update');

}, 2000);



</script>
</body>
</html>